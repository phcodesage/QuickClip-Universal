<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickClip Universal - Audio Cutter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/wavesurfer.js@7/dist/wavesurfer.min.css" rel="stylesheet">
    <style>
        /* Copy the root and common styles from index.html */
        :root {
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --accent-color: #00ff9d;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
        }

        /* Add audio cutter specific styles */
        .waveform-container {
            background-color: var(--secondary-dark);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .time-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
        }

        .time-input {
            width: 120px;
            text-align: center;
        }

        .audio-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .audio-controls button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-dark);
            border: 2px solid var(--accent-color);
            color: var(--accent-color);
            transition: all 0.3s ease;
        }

        .audio-controls button:hover {
            background: var(--accent-color);
            color: var(--primary-dark);
            transform: scale(1.1);
        }

        .upload-container {
            border: 2px dashed var(--accent-color);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .upload-container:hover {
            background-color: rgba(0, 255, 157, 0.1);
        }

        #waveform {
            background: var(--primary-dark);
            border-radius: 10px;
        }
    </style>
</head>
<body class="bg-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: var(--primary-dark);">
        <div class="container">
            <a class="navbar-brand" href="/">QuickClip Universal</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Video Downloader</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/audio-cutter">Audio Cutter</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <h1 class="hero-title">Audio Cutter</h1>
            <p class="hero-subtitle">Cut and trim your audio files with precision</p>
        </div>
    </section>

    <!-- Audio Cutter Section -->
    <section class="download-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <!-- URL Input -->
                    <div class="url-input-container mb-4">
                        <input type="text" class="form-control" id="url" placeholder="Paste YouTube URL or upload audio file">
                    </div>

                    <!-- Upload Container -->
                    <div class="upload-container" id="dropZone">
                        <i class="fas fa-cloud-upload-alt fa-3x mb-3" style="color: var(--accent-color);"></i>
                        <h4>Drag & Drop Audio File</h4>
                        <p class="text-secondary">or</p>
                        <input type="file" id="fileInput" accept="audio/*" style="display: none;">
                        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                            Choose File
                        </button>
                    </div>

                    <!-- Waveform Container -->
                    <div class="waveform-container" style="display: none;">
                        <div id="waveform"></div>
                        
                        <div class="time-controls">
                            <input type="number" class="form-control time-input" id="startTime" placeholder="Start Time">
                            <div class="audio-controls">
                                <button id="playBtn" class="btn"><i class="fas fa-play"></i></button>
                                <button id="pauseBtn" class="btn"><i class="fas fa-pause"></i></button>
                                <button id="stopBtn" class="btn"><i class="fas fa-stop"></i></button>
                            </div>
                            <input type="number" class="form-control time-input" id="endTime" placeholder="End Time">
                        </div>

                        <button class="btn btn-primary w-100" id="cutBtn">
                            <i class="fas fa-cut me-2"></i>Cut Audio
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/wavesurfer.js@7/dist/wavesurfer.min.js"></script>
    <script>
        let wavesurfer;
        let tempFilePath;

        // Initialize WaveSurfer
        function initWaveSurfer() {
            wavesurfer = WaveSurfer.create({
                container: '#waveform',
                waveColor: '#404040',
                progressColor: 'var(--accent-color)',
                cursorColor: '#00c3ff',
                height: 100,
                normalize: true,
                backend: 'WebAudio'
            });
        }

        // Handle file upload
        async function handleFile(file) {
            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch('/upload-audio', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error('Upload failed');
                
                const data = await response.json();
                tempFilePath = data.temp_path;
                
                document.querySelector('.waveform-container').style.display = 'block';
                document.querySelector('.upload-container').style.display = 'none';
                
                initWaveSurfer();
                wavesurfer.load(URL.createObjectURL(file));
                
                // Set end time to audio duration
                wavesurfer.on('ready', () => {
                    document.getElementById('endTime').value = wavesurfer.getDuration().toFixed(2);
                });
            } catch (error) {
                alert('Error uploading file: ' + error.message);
            }
        }

        // Handle YouTube URL
        async function handleYouTubeURL(url) {
            try {
                const formData = new FormData();
                formData.append('url', url);

                const response = await fetch('/upload-audio', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error('Download failed');
                
                const data = await response.json();
                tempFilePath = data.temp_path;
                
                document.querySelector('.waveform-container').style.display = 'block';
                
                initWaveSurfer();
                wavesurfer.load('/temp/' + data.filename);
                
                wavesurfer.on('ready', () => {
                    document.getElementById('endTime').value = wavesurfer.getDuration().toFixed(2);
                });
            } catch (error) {
                alert('Error processing YouTube URL: ' + error.message);
            }
        }

        // Cut audio
        async function cutAudio() {
            const startTime = parseFloat(document.getElementById('startTime').value) || 0;
            const endTime = parseFloat(document.getElementById('endTime').value) || wavesurfer.getDuration();

            try {
                const response = await fetch('/cut-audio', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        temp_path: tempFilePath,
                        start_time: startTime,
                        end_time: endTime
                    })
                });

                if (!response.ok) throw new Error('Cutting failed');
                
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'cut_audio.mp3';
                document.body.appendChild(a);
                a.click();
                a.remove();
                window.URL.revokeObjectURL(url);
            } catch (error) {
                alert('Error cutting audio: ' + error.message);
            }
        }

        // Event Listeners
        document.getElementById('url').addEventListener('change', function() {
            if (this.value.trim()) {
                handleYouTubeURL(this.value.trim());
            }
        });

        document.getElementById('fileInput').addEventListener('change', function(e) {
            if (e.target.files[0]) {
                handleFile(e.target.files[0]);
            }
        });

        document.getElementById('cutBtn').addEventListener('click', cutAudio);

        document.getElementById('playBtn').addEventListener('click', () => wavesurfer.play());
        document.getElementById('pauseBtn').addEventListener('click', () => wavesurfer.pause());
        document.getElementById('stopBtn').addEventListener('click', () => {
            wavesurfer.stop();
            wavesurfer.seekTo(0);
        });

        // Drag and drop handling
        const dropZone = document.getElementById('dropZone');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'rgba(0, 255, 157, 0.1)';
        });

        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'transparent';
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'transparent';
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('audio/')) {
                handleFile(file);
            } else {
                alert('Please drop an audio file');
            }
        });
    </script>
</body>
</html> 